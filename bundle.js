/**
 * This rewindJs demo is copyright 2022 James Jones
 */

(()=>{"use strict";const e=e=>({width:e.clientWidth,height:e.clientHeight}),t=(e=[],t=0,r=0)=>{let a={objects:e,renderBoundaryX:t,renderBoundaryY:r,maxSize:1e3};return a.deltaFunction=n,a},r=(e,t=0,r=0)=>{let a=e.objects;return e.renderBoundaryX,e.renderBoundaryY,a},a=(e,t=0,r=0)=>{let a=e.objects;return e.renderBoundaryX,e.renderBoundaryY,a},o=(e,t)=>{let r={...t},a=[...r.objects,...e];for(;a.length>r.maxSize;)a.shift();return r.objects=a,r},s=(e,t)=>{let r={...t},a=[];for(let r of t.objects)r.id===e.id?a.push(e):a.push({...r});return r.objects=a,r},n=(e,t,r,a)=>{let o={...e},s=[];for(let e of o.objects)!0!==e.remove&&s.push(e.deltaFunction(e,t,r,a));return o.objects=s,o},i={BOTTOM:"BOTTOM",TOP:"TOP",LEFT:"LEFT",RIGHT:"RIGHT"},c=(e,t,r,a,o,s,n,i)=>{let c=!1;return e<o+n&&e+r>o&&t<s+i&&t+a>s&&(c=!0),c},u=(e,t,r,a)=>{const o=(a-t)/(r-e);return{xFactor:o,offset:t-o*e}},l=(e,t,r)=>t+r*e,h=i,d=(e,t)=>{let r=!1;return!1===c(e.xp,e.yp,e.width,e.height,t.xp,t.yp,t.width,t.height)&&(r=c(e.x,e.y,e.width,e.height,t.x,t.y,t.width,t.height)),r},g=(e,t)=>((e,t,r,a,o,s,n,c,h,d)=>{const g=r-e,p=a-t;if(0===g&&0===p)return null;if(0==g)return p>0?i.BOTTOM:i.TOP;if(0==p)return g>0?i.LEFT:i.RIGHT;if(g>0&&p<0){const s=n,h=c+d,g=e+o,p=t,f=r+o,m=a,{xFactor:w,offset:X}=u(g,p,f,m);return h<=l(w,X,s)?i.TOP:i.LEFT}if(g<0&&p<0){const o=n+h,s=c+d,g=e,p=t,f=r,m=a,{xFactor:w,offset:X}=u(g,p,f,m);return s<=l(w,X,o)?i.TOP:i.RIGHT}if(g>0&&p>0){const h=n,d=c,g=e+o,p=t+s,f=r+o,m=a+s,{xFactor:w,offset:X}=u(g,p,f,m);return d>=l(w,X,h)?i.BOTTOM:i.LEFT}if(g<0&&p>0){const o=n+h,d=c,g=e,p=t+s,f=r,m=a+s,{xFactor:w,offset:X}=u(g,p,f,m);return d>=l(w,X,o)?i.BOTTOM:i.RIGHT}})(e.xp,e.yp,e.x,e.y,e.width,e.height,t.x,t.y,t.width,t.height);let p=0;const f=(e=0,t=0,r=0,a=0)=>{let o={x:e,y:t,width:r,height:a};return o.id=(p++,p),o.xp=e,o.yp=t,o.vectorX=0,o.vectorY=0,o.gravity=!0,o.gravityScale=1,o},m=(e,t,r)=>{let a={...e};return a.xp=a.x,a.yp=a.y,a=X(a,t,r),a=w(a,r),a},w=(e,t)=>{let r={...e};return r.x=r.x+r.vectorX*t,r.y=r.y+r.vectorY*t,r},X=(e,t,r)=>{let a={...e};return a.gravity&&(a.vectorY=Math.max(t.minVerticalVelocityPerSecond,a.vectorY+=t.gravityAccelerationPerSecond*r)),a},y=document.getElementById("colours"),b=(e=100,t=100,r=300,a=20,o=y)=>{let s=f(e,t,r,a);return s.image=o,s.spriteDelta=0,s.frame=0,s.deltaFunction=v,s.spriteFunction=M,s},v=(e,t,r)=>{let a={...e};return a.spriteDelta+=r,a.spriteDelta>.1&&(a.frame=Math.floor(5*Math.random()),a.spriteDelta=a.spriteDelta%.1),a},M=e=>{let t={imageName:"platformColours"};return t.source=e.image,t.sourceX=2*e.frame,t.sourceY=2,t.sourceWidth=2,t.sourceHeight=2,t.spriteX=e.x,t.spriteY=e.y,t.spriteWidth=e.width,t.spriteHeight=e.height,t};let x=!1,D=!1,Y=!1,S=!1,F=!1;const T=e=>{"d"===e&&(Y=!0),"a"===e&&(D=!0)," "===e&&(x=!0),"ArrowLeft"===e&&(S=!0),"b"===e&&(F=!0)},C=e=>{"d"===e&&(Y=!1),"a"===e&&(D=!1)," "===e&&(x=!1),"ArrowLeft"===e&&(S=!1),"b"===e&&(F=!1)},k=document.getElementById("Run"),H=document.getElementById("Jump"),I="STANDING",O="RUNNING",E="JUMPING",P="FALLING",W="DEAD",j="RIGHT",L="LEFT",N=(e,t,r)=>{let a={...e};if(a.shootingGun=!1,e.state===W)return a;if(a.vectorX=0,a.state=I,a.lastShot+=r,B(a),A(a),V(a),a=m(a,t,r),a.vectorY>0?a.state=E:a.vectorY<0&&(a.state=P),a.state===O){const e=U(a);a.gunHeight=2===e||6===e?29:1===e||3===e||5===e||7===e?26:23}return a.spriteDelta+=r,a},R=(e,t)=>{let r={...e};return r.y=t.y+t.height,r.state===P&&(r.state=I,B(r)),r.vectorY=0,r},G=(e,t)=>{let r={...e};return r.state=W,r},B=e=>{D&&(e.vectorX=-130,e.state===I&&(e.state=O),e.facing=L),Y&&(e.vectorX=130,e.state===I&&(e.state=O),e.facing=j)},A=e=>{x&&(e.state!==I&&e.state!==O||(e.vectorY=300,e.state))},V=e=>{F&&e.lastShot>=.1&&(e.shootingGun=!0,e.lastShot=0)},J=e=>{let t={};return e.state===I?t=z(e):e.state===O?t=$(e):e.state===E?t=q(e):e.state===P&&(t=K(e)),t.spriteX=t.spriteX+e.drawXOffset,t.spriteY=t.spriteY+e.drawYOffset,t.spriteWidth=e.drawWidth,t.spriteHeight=e.drawHeight,t},z=e=>{let t={imageName:"redJump"};return t.source=H,t.sourceX=28,t.sourceY=24,t.sourceWidth=72,t.sourceHeight=60,t.spriteX=e.x,t.spriteY=e.y,t.spriteWidth=e.width,t.spriteHeight=e.height,e.facing===L&&(t.sourceY+=128),t},U=e=>Math.floor(e.spriteDelta%.5/.0625),$=e=>{let t={imageName:"redRun"};switch(t.source=k,t.sourceX=28,t.sourceY=24,t.sourceWidth=72,t.sourceHeight=60,U(e)){case 0:default:break;case 1:t.sourceX+=128;break;case 2:t.sourceX+=256;break;case 3:t.sourceX+=384;break;case 4:t.sourceX+=512;break;case 5:t.sourceX+=640;break;case 6:t.sourceX+=768;break;case 7:t.sourceX+=896}return e.facing===L&&(t.sourceY+=128),t.spriteX=e.x,t.spriteY=e.y,t.spriteWidth=e.width,t.spriteHeight=e.height,t},q=e=>{let t={imageName:"redJump"};return t.source=H,t.sourceX=28,t.sourceY=24,t.sourceWidth=72,t.sourceHeight=64,t.sourceX+=128,e.facing===L&&(t.sourceY+=128),t.spriteX=e.x,t.spriteY=e.y,t.spriteWidth=e.width,t.spriteHeight=e.height,t},K=e=>{let t={imageName:"redJump"};return t.source=H,t.sourceX=28,t.sourceY=24,t.sourceWidth=72,t.sourceHeight=64,t.sourceX+=256,e.facing===L&&(t.sourceY+=128),t.spriteX=e.x,t.spriteY=e.y,t.spriteWidth=e.width,t.spriteHeight=e.height,t},Q=[{x:10,y:30,width:300,height:40},{x:230,y:100,width:160,height:30},{x:400,y:40,width:200,height:30},{x:650,y:70,width:100,height:50},{x:850,y:60,width:200,height:30}],Z=[{x:-200,y:-1e3,width:1e4,height:150}],_=[{x:270,y:80,boundToPlatform:!1},{x:240,y:200,boundToPlatform:!1},{x:400,y:140,boundToPlatform:!1},{x:650,y:170,boundToPlatform:!1},{x:870,y:100,boundToPlatform:!1}],ee=e=>{let t=[];return e.background,t.push(...r(e.fadeManager)),t.push(...r(e.platformManager)),t.push(...r(e.crawlerManager)),t.push(...r(e.bulletManager)),t.push(e.me),t.push(...r(e.sparkManager)),t},te=(e,t)=>({spriteX:e.spriteX,spriteY:t.canvas.height-e.spriteY-e.spriteHeight}),re=(e,t)=>{e.stackDelta=0,e.states.push(t),e.states.length>e.maxStackSize&&e.states.shift()},ae=e=>e.stackDelta>1,oe=document.getElementById("background"),se=(e,t)=>{let r={...e};return r.spriteDelta+=t,r},ne=e=>{let t={imageName:"background"};return t.source=e.image,t.sourceX=2,t.sourceY=2,t.sourceWidth=2,t.sourceHeight=2,t.spriteX=e.x,t.spriteY=e.y,t.spriteWidth=e.width,t.spriteHeight=e.height,t},ie=document.getElementById("Crawler"),ce="RUNNING",ue="FALLING",le="RIGHT",he="LEFT",de=(e=100,t=100)=>{let r={state:ue,facing:he,boundToPlatform:!1,platformId:0,injured:!1};return r={...f(),...r},r.spriteDelta=0,r.x=e,r.y=t,r.xOffset=0,r.width=44,r.height=24,r.life=4,r.direction=-1,r.deltaFunction=ge,r.spriteFunction=we,r},ge=(e,t,r,a)=>{let o={...e};if(o.spriteDelta+=r,o.state===ce){const e=me(o);2==e||1==e?o.vectorX=0:o.direction<0?o.vectorX=-50:o.vectorX=50,1===e||3===e?(o.width=40,o.height=28,o.facing===le&&(o.xOffset=4)):2===e?(o.width=36,o.height=28,o.facing===le&&(o.xOffset=8)):0===e&&(o.width=44,o.height=24,o.facing===le&&(o.xOffset=0))}if(o.injured&&(o.injuredDelta+=r,o.injuredDelta>.2?(o.injured=!1,o.injuredDelta=0):o.vectorX=0),o=m(o,t,r),o.state===ce&&(o.spriteDelta=o.spriteDelta%100,!0===o.boundToPlatform)){let e=((e,t)=>{for(let r of e.objects)if(r.id===t)return r})(a,o.platformId);o.x<e.x?(o.direction=1,o.facing=le,o.vectorX=-1*o.vectorX):o.x+o.width>e.x+e.width&&(o.direction=-1,o.facing=he,o.vectorX=-1*o.vectorX)}return o},pe=(e,t)=>{let r={...e};return r.boundToPlatform=!0,r.platformId=t.id,r.y=t.y+t.height,r.state===ue&&(r.state=ce),r.vectorY=0,0===r.vectorX&&(r.vectorX=50),r},fe=(e,t)=>{let r={...e};return r.life>0?r.life-=1:r.remove=!0,t.vectorX>0&&(r.x+=6),t.vectorX<0&&(r.x-=6),r.injured=!0,r.injuredDelta=0,r},me=e=>Math.floor(e.spriteDelta%.5/.125),we=e=>{let t={imageName:"crawler"};if(t.source=ie,t.sourceX=0,t.sourceY=8,t.sourceWidth=e.width,t.sourceHeight=e.height,t.spriteX=e.x+e.xOffset,t.spriteY=e.y,t.spriteWidth=e.width,t.spriteHeight=e.height,e.state===ce){const r=me(e);switch(t.sourceX=128*r,r){case 0:t.sourceY=8;break;case 1:case 2:case 3:t.sourceY=4}e.facing===le&&(t.sourceY+=128)}return!0===e.injured&&(t.sourceY+=256),t},Xe=document.getElementById("Crawler"),ye="SLIDING",be="FALLING",ve=(e,t,r,a)=>{let o=m(e,t,r);return 0!=o.vectorX&&0!=o.vectorY&&(o.state===ye&&!0===o.boundToPlatform&&(Math.abs(o.vectorX)<10?o.vectorX=0:o.vectorX<0?o.vectorX+=10:o.vectorX-=10),o.boundToPlatform=!1),o},Me=(e,t)=>{let r={...e};return r.platformId=t.id,r.y=t.y+t.height,r.state=ye,r.boundToPlatform=!0,r.vectorY=0,r},xe=e=>{let t={imageName:"crawler"};return t.source=Xe,t.sourceX=20,t.sourceY=20,t.sourceWidth=2,t.sourceHeight=2,t.spriteX=e.x,t.spriteY=e.y,t.spriteWidth=e.width,t.spriteHeight=e.height,t},De=document.getElementById("colours"),Ye=(e,t,r)=>{let a=m(e,t,r);return a.life+=r,a.life>4&&(a.remove=!0),a},Se=e=>{let t={...e};return t.remove=!0,t},Fe=e=>{let t={imageName:"platformColours"};return t.source=De,t.sourceX=9,t.sourceY=2,t.sourceWidth=2,t.sourceHeight=2,t.spriteX=e.x,t.spriteY=e.y,t.spriteWidth=e.width,t.spriteHeight=e.height,t},Te=(e,t,r)=>{let a={...e};return a.newStarX=null,a.newStarY=null,a.newStarXVector=0,a.newStarYVector=0,a.spawnDelta+=r,a.spawnDelta>=a.currentSpawnRate&&(a.currentSpawnRate=.1+.1*Math.random(),a.spawnDelta=0,a.newStarXVector=20,a.newStarYVector=-10,a.newStarX=Math.random()*a.canvasContext.canvas.width-100,a.newStarY=Math.random()*a.canvasContext.canvas.height+100),a},Ce=e=>null,ke=(e,t,r,a)=>{let o=m(e,t,r);return o.fadeDelta+=r,o.fadeDelta>o.fadeInSpeed+o.fadeOutSpeed&&(o.remove=!0),o},He=e=>{let t={},r=1/e.fadeInSpeed*e.fadeDelta,a=r*e.originalAlpha;e.fadeDelta>e.fadeInSpeed&&(r=1/e.fadeOutSpeed*(e.fadeDelta-e.fadeInSpeed),a=(1-r)*e.originalAlpha);let o=`rgba(${e.red}, ${e.green}, ${e.blue}, ${a})`;return t.spriteX=e.x,t.spriteY=e.y,t.spriteWidth=e.width,t.spriteHeight=e.height,t.colour=o,t},Ie=(e,t)=>{let r={scale:e,life:t,shakeDelta:0};return r={...f(),...r},r.vectorX=5,r.vectorY=5,r.deltaFunction=Oe,r},Oe=(e,t,r,a)=>{let o={...e};return o.shakeDelta+=r,Math.random()>=.5?o.x=5*o.scale:o.x=-5*o.scale,Math.random()>=.5?o.y=5*o.scale:o.y=-5*o.scale,o.shakeDelta>=.2&&(o.remove=!0),o},Ee=(e,t,r)=>{const a=((e=100,t=100)=>{let r={state:be,boundToPlatform:!1,platformId:0};r={...f(),...r},r.vectorX=400*Math.random()-200,r.vectorY=30+570*Math.random(),r.spriteDelta=0,r.x=e,r.y=t;let a=1+6*Math.random();return r.width=a,r.height=a,r.deltaFunction=ve,r.spriteFunction=xe,r})(e,t);return o([a],r)},Pe=(e,t,r,a,s,n)=>{const i=((e=100,t=100,r,a,o)=>{let s={state:be,boundToPlatform:!1,platformId:0};return s={...f(),...s},s.vectorX=400*Math.random()-200,s.vectorY=30+570*Math.random(),s.spriteDelta=0,s.x=e,s.y=t,s.width=r,s.height=a,s.gravity=o,s.deltaFunction=ve,s.spriteFunction=xe,s})(e,t,r,a,s);return o([i],n)},We=(e,r)=>{let n=!1,i=((e=3e3)=>({states:[],maxStackSize:e,stackDelta:0}))(1e3),u=!1,l=(e=>{let r={};r.background=((e=100,t=100,r=300,a=20,o=oe)=>{let s=f(e,t,r,a);return s.image=o,s.spriteDelta=0,s.frame=0,s.deltaFunction=se,s.spriteFunction=ne,s})(10,10,800,500),r.backgroundColour="rgba(0, 0, 0, 0)",r.cameraEffectsManager=t([]),r.cameraEffects=[];const a=((e=20,t=100)=>{let r={state:I,facing:j};return r={...f(),...r},r.shootingGun=!1,r.gunHeight=23,r.x=e,r.y=t,r.width=21,r.height=42,r.lastShot=0,r.drawXOffset=-10,r.drawYOffset=0,r.drawWidth=54,r.drawHeight=48,r.deltaFunction=N,r.spriteFunction=J,r.spriteDelta=0,r})(30,200),o=Q;let s=[];for(let e of o){const{x:t,y:r,width:a,height:o}=e,n=b(t,r,a,o);s.push(n)}const n=Z;let i=[];for(let e of n)i.push({...e});let c=[];for(let e of _){const{x:t,y:r,boundToPlatform:a}=e,o=de(t,r);c.push(o)}const u=t(s),l=t(c),h=t([]);h.maxSize=100;const d=t([]),g=t([]),p=(e=>{let t={spawnDelta:0,currentSpawnRate:.1};return t.deltaFunction=Te,t.spriteFunction=Ce,t.canvasContext=e,t})(e);return r.world={gravityAccelerationPerSecond:-1200,minVerticalVelocityPerSecond:-1200},r.me=a,r.platformManager=u,r.crawlerManager=l,r.sparkManager=h,r.bulletManager=d,r.baseLight=[0,1,0,1],r.boundaries=i,r.fadeManager=g,r.starscape=p,r.demoUser={userDelta:0,shootCount:0,runCount:0,jumpCount:0,pressingShoot:!1,pressingJump:!1,pressingLeft:!1,pressingRight:!1},r.getSpritesFunction=ee,r})(e);re(i,l);const p=((e,t=1/120,r=.1)=>{let a=new Date,o=!0;const s=()=>{const t=new Date;let n=(t-a)/1e3;n=n>r?r:n,a=t,a=t,e(n),!0===o&&window.requestAnimationFrame((()=>{s()}))};return window.requestAnimationFrame((()=>{s()})),()=>{o=!1}})((t=>{let p,m="spotlight";if(r(),S&&(n=!0,C("ArrowLeft")),n&&((w=i).stackDelta+3<=w.states.length?(p=(e=>{for(let t=0;t<3&&e.states.length>1;t++)e.states.pop();e.stackDelta=0;let t=e.states.length-1;return e.states[t]})(i),l=p,"rewind"):n=!1),!1===n&&ae(i)&&(p=(e=>{if(ae(e)){e.stackDelta=e.stackDelta-1;const t=e.states.length-e.stackDelta;return e.states[t]}})(i),l=p),void 0===p){if(u=!1,p={...l},p.baseLight={...l.baseLight},p.me=l.me.deltaFunction(p.me,p.world,t),p.platformManager=l.platformManager.deltaFunction(p.platformManager,p.world,t),p.crawlerManager=l.crawlerManager.deltaFunction(p.crawlerManager,p.world,t,p.platformManager),p.sparkManager=l.sparkManager.deltaFunction(p.sparkManager,p.world,t,p.platformManager),p.bulletManager=l.bulletManager.deltaFunction(p.bulletManager,p.world,t,p),p.starscape=l.starscape.deltaFunction(p.starscape,p.world,t),p.fadeManager=l.bulletManager.deltaFunction(p.fadeManager,p.world,t,p),p.cameraEffectsManager=l.cameraEffectsManager.deltaFunction(p.cameraEffectsManager,p.world,t,p),!0===p.me.shootingGun){let e=(v=(b=p.me).x,M=b.y+b.gunHeight,x=400,b.facing===L&&(x*=-1),b.facing===L?v-=35:v+=45,{sourceX:v,sourceY:M,vectorX:x,vectorY:0});p.bulletManager=((e,t,r,a,s)=>{const n=((e=100,t=100,r,a)=>{let o={};return o={...f(),...o},o.gravity=!1,o.remove=!1,o.life=0,o.vectorX=r,o.vectorY=a,o.spriteDelta=0,o.x=e,o.y=t,o.width=30,o.height=6,o.deltaFunction=Ye,o.spriteFunction=Fe,o})(e,t,r,a);return o([n],s)})(e.sourceX,e.sourceY,e.vectorX,e.vectorY,p.bulletManager)}let e=[];for(let t of l.boundaries)e.push({...t});p.boundaries=e;for(let e of a(p.platformManager)){d(p.me,e)&&g(p.me,e)===h.TOP&&(p.me=R(p.me,e));for(let t of a(p.crawlerManager))d(t,e)&&g(t,e)===h.TOP&&(p.crawlerManager=s(pe(t,e),p.crawlerManager));for(let t of a(p.sparkManager))d(t,e)&&g(t,e)===h.TOP&&(p.sparkManager=s(Me(t,e),p.sparkManager))}for(let e of a(p.bulletManager))for(let t of a(p.crawlerManager))if(d(t,e)){p.crawlerManager=s(fe(t,e),p.crawlerManager);let r=t.x,a=e.y+e.height/2;e.vectorX<0&&(r=t.x+t.width);for(let e=0;e<8;e++)p.sparkManager=Ee(r,a,p.sparkManager);if(0===t.life){for(let e=0;e<5;e++)p.sparkManager=Pe(r,a,12,12,!0,p.sparkManager);p.cameraEffectsManager=o([Ie(1,.5)],p.cameraEffectsManager)}else p.cameraEffectsManager=o([Ie(.2,.5)],p.cameraEffectsManager);p.bulletManager=s(Se(e),p.bulletManager)}for(let e of p.boundaries)X=p.me,y=e,c(X.x,X.y,X.width,X.height,y.x,y.y,y.width,y.height)&&(p.me=G(p.me));null!==p.starscape.newStarX&&(p.fadeManager=((e,t,r,a,s,n,i,c,u)=>{const l=((e,t,r,a,o,s,n,i,c)=>{let u={};return u={...f(),...u},u.red=n.r,u.green=n.g,u.blue=n.b,u.originalAlpha=n.a,u.fadeInSpeed=i,u.fadeOutSpeed=c,u.fadeDelta=0,u.x=e,u.y=t,u.width=r,u.height=a,u.vectorX=o,u.vectorY=s,u.gravity=!1,u.deltaFunction=ke,u.spriteFunction=He,u})(e,t,r,a,s,n,i,c,c);return o([l],u)})(p.starscape.newStarX,p.starscape.newStarY,4,4,p.starscape.newStarXVector,p.starscape.newStarYVector,{r:255,g:255,b:255,a:1},7,p.fadeManager)),p.demoUser=((e,t,r)=>{let a={...e};return a.userDelta+=r,a.pressingShoot&&(C("b"),a.pressingShoot=!1),a.userDelta>=1&&a.shootCount<1&&(T("b"),a.pressingShoot=!0,a.shootCount++),a.userDelta>=1.2&&a.shootCount<2&&(T("b"),a.pressingShoot=!0,a.shootCount++),a.userDelta>=1.4&&a.shootCount<3&&(T("b"),a.pressingShoot=!0,a.shootCount++),a.userDelta>=1.6&&a.shootCount<4&&(T("b"),a.pressingShoot=!0,a.shootCount++),a.userDelta>=1.8&&a.shootCount<5&&(T("b"),a.pressingShoot=!0,a.shootCount++),a.userDelta>=2.4&&a.runCount<1&&(T("d"),a.pressingRight=!0,a.runCount++),a.userDelta>=2.6&&a.shootCount<6&&(T("b"),a.pressingShoot=!0,a.shootCount++),a.userDelta>=2.8&&a.jumpCount<1&&(T(" "),a.pressingJump=!0,a.jumpCount++),a.userDelta>=3.2&&!0===a.pressingJump&&1===a.jumpCount&&(C(" "),a.pressingJump=!1),a.userDelta>=4&&a.pressingRight&&(C("d"),a.pressingRight=!1),a.userDelta>=3&&a.shootCount<7&&(T("b"),a.pressingShoot=!0,a.shootCount++),a.userDelta>=4.1&&a.shootCount<8&&(T("b"),a.pressingShoot=!0,a.shootCount++),a.userDelta>=4.3&&a.shootCount<9&&(T("b"),a.pressingShoot=!0,a.shootCount++),a.userDelta>=4.5&&a.shootCount<10&&(T("b"),a.pressingShoot=!0,a.shootCount++),a.userDelta>=4.7&&a.shootCount<11&&(T("b"),a.pressingShoot=!0,a.shootCount++),a.userDelta>=6&&T("ArrowLeft"),a})(p.demoUser,0,t),p.cameraEffects=a(p.cameraEffectsManager),l=p,re(i,l)}var w,X,y,b,v,M,x;((e,t)=>{if(t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,t.canvas.width,t.canvas.height),e.cameraEffects.length>0)for(let r of e.cameraEffects)t.translate(r.x,r.y);t.fillStyle=e.backgroundColour,t.fillRect(0,0,t.canvas.width,t.canvas.height);for(let r of e.getSpritesFunction(e)){let e=r.spriteFunction(r);if(e){const r=te(e,t);e.spriteX=r.spriteX,e.spriteY=r.spriteY,e.source?t.drawImage(e.source,e.sourceX,e.sourceY,e.sourceWidth,e.sourceHeight,e.spriteX,e.spriteY,e.spriteWidth,e.spriteHeight):(t.fillStyle=e.colour,t.fillRect(e.spriteX,e.spriteY,e.spriteWidth,e.spriteHeight))}}})(p,e)}),25);return()=>{p()}};(()=>{let t=document.body;const{canvas:r,context:a,resizeCallback:o}=((t,r)=>((t,r,a)=>{let o=e(r),s=document.createElement("canvas");return r.appendChild(s),s.id=t,s.width=o.width,s.height=o.height,{context:s.getContext(a),canvas:s,resizeCallback:()=>{o=e(r),s.width===o.width&&s.height===o.height||(s.width=o.width,s.height=o.height)}}})("slugsCanvas",r,"2d"))(0,t);We(a,o)})()})();